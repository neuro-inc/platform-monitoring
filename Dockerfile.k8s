FROM python:3.6.6-stretch

WORKDIR /neuromation

ARG PIP_INDEX_URL

# installing dependencies ONLY
COPY setup.py ./
RUN \
    pip install -e . && \
    pip uninstall -y platform-monitoring

# installing platform-monitoring
COPY platform_monitoring platform_monitoring
RUN pip install -e .

ENV NP_MON_API_PORT=8088
EXPOSE $NP_MON_API_PORT

CMD platform-mon